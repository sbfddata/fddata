<!DOCTYPE html>
<html lang="si">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Investment System Pro - Padiyathalawa</title>
Â  Â  <style>
Â  Â  Â  Â  body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f6; margin: 0; padding: 0; }
Â  Â  Â  Â  .header { background: #90caf9; padding: 20px; text-align: center; font-size: 24px; font-weight: bold; }
Â  Â  Â  Â  .container { background: white; max-width: 600px; margin: 20px auto; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
Â  Â  Â  Â  label { display: block; margin-top: 10px; font-weight: bold; font-size: 14px; }
Â  Â  Â  Â  input, select { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .search-container { background: #fffde7; padding: 15px; border: 1px solid #fbc02d; border-radius: 8px; margin-bottom: 20px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
Â  Â  Â  Â  button { padding: 12px; cursor: pointer; border: none; border-radius: 5px; color: white; font-weight: bold; }
Â  Â  Â  Â  .search-btn { background: #f1c40f; color: black; width: 100%; margin-top: 10px; }
Â  Â  Â  Â  .add { background: #2ecc71; }Â 
Â  Â  Â  Â  .edit { background: #3498db; } .delete { background: #e74c3c; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #login-area { text-align: center; } #system-area { display: none; }
Â  Â  </style>
</head>
<body>

<div class="header">à·ƒà¶¸à·˜à¶¯à·Šà¶°à·’ à¶´à·Šâ€à¶»à¶¢à·à¶¸à·–à¶½ à¶¶à·à¶‚à¶šà·” à·ƒà¶¸à·’à¶­à·’à¶º - à¶´à¶¯à·’à¶ºà¶­à¶½à·à·€</div>

<div id="login-area" class="container">
Â  Â  <h3 style="color: purple;">LOGIN</h3>
Â  Â  <input type="text" id="user" placeholder="UserName">
Â  Â  <input type="password" id="pass" placeholder="Password">
Â  Â  <button style="background: #00bcd4; width: 100%;" onclick="doLogin()">Login</button>
</div>

<div id="system-area" class="container">
Â  Â  <h3 style="color: purple; text-align: center;">Investment Management Information System</h3>
Â  Â Â 
Â  Â  <div class="search-container">
Â  Â  Â  Â  <label>Enter receipt number:</label>
Â  Â  Â  Â  <input type="text" id="searchId" placeholder="Enter receipt number to search data">
Â  Â  Â  Â  <button class="search-btn" onclick="process('searchData')">ğŸ” Data Search</button>
Â  Â  </div>

Â  Â  <hr>

Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶¸à·”à¶¯à¶½ à¶…à¶ºà¶­à·Š à¶¶à·à¶‚à¶šà·”à·€ / à¶œà·’à¶«à·”à¶¸à·š à¶±à¶¸:</label>
Â  Â  <select id="colA" required>
Â  Â  Â  Â  <option value="" disabled selected hidden>Select Investment Account...</option>
Â  Â  Â  Â  <option value="à¶´à¶¯à·’à¶ºà¶­à¶½à·à·€ à·ƒà¶¸à·˜à¶¯à·Šà¶°à·’ à¶¶à·à¶‚à¶šà·”à·€">à¶´à¶¯à·’à¶ºà¶­à¶½à·à·€ à·ƒà¶¸à·˜à¶¯à·Šà¶°à·’ à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶´à¶½à·Šà¶½à·šà¶œà¶¸ à·ƒà¶¸à·˜à¶¯à·Šà¶°à·’ à¶¶à·à¶‚à¶šà·”à·€">à¶´à¶½à·Šà¶½à·šà¶œà¶¸ à·ƒà¶¸à·˜à¶¯à·Šà¶°à·’ à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶¸à·„ à·ƒà¶‚à¶œà¶¸à·Š à¶…à¶»à¶¸à·”à¶¯à¶½">à¶¸à·„ à·ƒà¶‚à¶œà¶¸à·Š à¶…à¶»à¶¸à·”à¶¯à¶½</option>
Â  Â  Â  Â  <option value="à¶«à¶º à·ƒà¶‚à¶»à¶šà·Šà·‚à¶« à¶…à¶»à¶¸à·”à¶¯à¶½à·Š">à¶«à¶º à·ƒà¶‚à¶»à¶šà·Šà·‚à¶« à¶…à¶»à¶¸à·”à¶¯à¶½à·Š</option>
Â  Â  Â  Â  <option value="à·ƒà¶¸à·–à·„ à·ƒà¶‚à¶»à¶šà·Šà·‚à¶« à¶…à¶»à¶¸à·”à¶¯à¶½à·Š">à·ƒà¶¸à·–à·„ à·ƒà¶‚à¶»à¶šà·Šà·‚à¶« à¶…à¶»à¶¸à·”à¶¯à¶½à·Š</option>
Â  Â  </select>

Â  Â  <label>à¶†à¶ºà·à¶¢à¶±à¶º à¶šà·… à¶¶à·à¶‚à¶šà·”à·€à·š à¶±à¶¸:</label>
Â  Â  <select id="colB" required>
Â  Â  Â  Â  <option value="" disabled selected hidden>Select Bank...</option>
Â  Â  Â  Â  <option value="à¶½à¶‚à¶šà· à¶¶à·à¶‚à¶šà·”à·€">à¶½à¶‚à¶šà· à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶¸à·„à¶¢à¶± à¶¶à·à¶‚à¶šà·”à·€">à¶¸à·„à¶¢à¶± à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶´à·Šâ€à¶»à·à¶¯à·šà·à·“à¶º à·ƒà¶‚à·€à¶»à·Šà¶°à¶± à¶¶à·à¶‚à¶šà·”à·€">à¶´à·Šâ€à¶»à·à¶¯à·šà·à·“à¶º à·ƒà¶‚à·€à¶»à·Šà¶°à¶± à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶±à·’à·€à·à·ƒ à·ƒà¶‚à·€à¶»à·Šà¶°à¶± à¶¸à·–à¶½à·Šâ€à¶º à·ƒà¶‚à·ƒà·Šà¶®à·à·€">à¶±à·’à·€à·à·ƒ à·ƒà¶‚à·€à¶»à·Šà¶°à¶± à¶¸à·–à¶½à·Šâ€à¶º à·ƒà¶‚à·ƒà·Šà¶®à·à·€</option>
Â  Â  Â  Â  <option value="à¶»à·à¶¢à·Šâ€à¶º à¶‹à¶šà·ƒà·Š à·„à· à¶†à¶ºà·à¶¢à¶± à¶¶à·à¶‚à¶šà·”à·€">à¶»à·à¶¢à·Šâ€à¶º à¶‹à¶šà·ƒà·Š à·„à· à¶†à¶ºà·à¶¢à¶± à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  Â  Â  <option value="à¶¢à·à¶­à·’à¶š à¶‰à¶­à·’à¶»à·’à¶šà·’à¶»à·“à¶¸à·š à¶¶à·à¶‚à¶šà·”à·€">à¶¢à·à¶­à·’à¶š à¶‰à¶­à·’à¶»à·’à¶šà·’à¶»à·“à¶¸à·š à¶¶à·à¶‚à¶šà·”à·€</option>
Â  Â  </select>

Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶šà·… à¶¯à·’à¶±à¶º:</label>
Â  Â  <input type="date" id="colC" onchange="calculateDuration()">

Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶»à·’à·ƒà·’à¶§à·Šà¶´à¶­à·Š à¶…à¶‚à¶šà¶º:</label>
Â  Â  <input type="text" id="colD" >

Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶¸à·”à¶¯à¶½ (à¶»à·”):</label>
Â  Â  <input type="number" id="colE">Â  Â 
Â  Â 
Â  Â  <label>à¶†à¶ºà·à¶¢à¶±à¶º à¶šà¶½à·Šà¶´à·’à¶»à·™à¶± à¶¯à·’à¶±à¶º:</label>
Â  Â  <input type="date" id="colG" onchange="calculateDuration()">
Â  Â Â 
Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶šà·à¶½à¶º: </label>
Â  Â  <select id="colF" disabled>Â Â 
Â  Â  Â  Â  <option value="" selected>Investment period is automatically selected</option>
Â  Â  Â  Â  <option value="à¶¸à·à·ƒ 01">à¶¸à·à·ƒ 01à¶šà·’ </option>
Â  Â  Â  Â  <option value="à¶¸à·à·ƒ 03">à¶¸à·à·ƒ 03à¶šà·’ </option>
Â  Â  Â  Â  <option value="à¶¸à·à·ƒ 06">à¶¸à·à·ƒ 06à¶šà·’ </option>
Â  Â  </select>
Â  Â Â 
Â  Â  <label>à¶†à¶ºà·à¶¢à¶± à¶´à·œà¶½à·’ à¶´à·Šâ€à¶»à¶­à·’à·à¶­à¶º:</label>
Â  Â  <input type="text" id="colH" placeholder="Ex: 7" onblur="addPercentSymbol(this)">
Â  Â Â 
Â  Â  <label>à¶†à¶ºà·à¶¢à¶±à¶º à·ƒà¶³à·„à· à¶½à¶¯ à¶´à·œà¶½à·’à¶º (à¶»à·”):</label>
Â  Â  <input type="text" id="colI">

Â  Â  <label>à¶ à·™à¶šà·Šà¶´à¶­à·Š à¶…à¶‚à¶šà¶º:</label>
Â  Â  <input type="text" id="colJ">

Â  Â  <div class="btn-grid">
Â  Â  Â  Â  <button class="add" onclick="process('addData')">Data Add</button>
Â  Â  Â  Â  <button class="edit" onclick="process('editData')">Data Edit</button>
Â  Â  Â  Â  <button class="delete" onclick="process('deleteData')">Data Delete</button>
Â  Â  </div>
</div>

<script>
Â  Â  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxOzu1pMPRGSpmq6qAH1HPTrVCsiejjit6jIyyOnHwdhj5kR_uOGyFxdGpQVx71WE6uDg/exec";

Â  Â  function doLogin() {
Â  Â  Â  Â  let u = document.getElementById('user').value;
Â  Â  Â  Â  let p = document.getElementById('pass').value;
Â  Â  Â  Â  fetch(`${SCRIPT_URL}?action=login&username=${u}&password=${p}`, {method: 'POST'})
Â  Â  Â  Â  .then(r => r.text())
Â  Â  Â  Â  .then(res => {
Â  Â  Â  Â  Â  Â  if(res.trim() === "success") {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('login-area').style.display='none';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('system-area').style.display='block';
Â  Â  Â  Â  Â  Â  } else { alert("Incorrect username or password!"); }
Â  Â  Â  Â  });
Â  Â  }

Â  Â Â 
Â  Â  function addPercentSymbol(input) {
Â  Â  Â  Â  let val = input.value.trim();
Â  Â  Â  Â  if (val !== "" && !isNaN(val)) {
Â  Â  Â  Â  Â  Â  input.value = val + "%";
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function calculateDuration() {
Â  Â  Â  Â  let startDate = new Date(document.getElementById('colC').value);
Â  Â  Â  Â  let endDate = new Date(document.getElementById('colG').value);
Â  Â  Â  Â  let durationSelect = document.getElementById('colF');
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!isNaN(startDate) && !isNaN(endDate)) {
Â  Â  Â  Â  Â  Â  let diffTime = Math.abs(endDate - startDate);
Â  Â  Â  Â  Â  Â  let diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (diffDays >= 28 && diffDays <= 32) {
Â  Â  Â  Â  Â  Â  Â  Â  durationSelect.value = "à¶¸à·à·ƒ 01";
Â  Â  Â  Â  Â  Â  } else if (diffDays >= 88 && diffDays <= 94) {
Â  Â  Â  Â  Â  Â  Â  Â  durationSelect.value = "à¶¸à·à·ƒ 03";
Â  Â  Â  Â  Â  Â  } else if (diffDays >= 175 && diffDays <= 184) {
Â  Â  Â  Â  Â  Â  Â  Â  durationSelect.value = "à¶¸à·à·ƒ 06";
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  durationSelect.value = "";Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }    

Â  Â  async function process(actionName) {
Â  Â  Â  Â  // à¶…à¶½à·”à¶­à·Š fields à¶…à¶±à·”à¶´à·’à·…à·’à·€à·™à¶½: A à·ƒà·’à¶§ J à¶¯à¶šà·Šà·€à·
Â  Â  Â  Â  let fields = ['colA','colB','colC','colD','colE','colF','colG','colH','colI','colJ'];
Â  Â  Â  Â  let params = new URLSearchParams();
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(actionName === 'searchData') {
Â  Â  Â  Â  Â  Â  let sId = document.getElementById('searchId').value;
Â  Â  Â  Â  Â  Â  if(!sId) { alert("Please enter the receipt number to search!"); return; }
Â  Â  Â  Â  Â  Â  params.append('colD', sId);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  fields.forEach(f => params.append(f, document.getElementById(f).value));
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  params.append('action', actionName);

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  let response = await fetch(`${SCRIPT_URL}?${params.toString()}`, {method: 'POST'});
Â  Â  Â  Â  Â  Â  let text = await response.text();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  let data = JSON.parse(text);
Â  Â  Â  Â  Â  Â  Â  Â  if(actionName === 'searchData') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fields.forEach((f, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let element = document.getElementById(f);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if((i === 2 || i === 6) && data[i]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let dateVal = new Date(data[i]);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!isNaN(dateVal)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  element.value = dateVal.toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  element.value = (data[i] !== undefined && data[i] !== null) ? data[i] : "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  calculateDuration();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Data found!");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Response: " + text);
Â  Â  Â  Â  Â  Â  Â  Â  if(actionName !== 'searchData' && text.toLowerCase().includes("success")) location.reload();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch(err) {
Â  Â  Â  Â  Â  Â  alert("Error!: " + err.message);
Â  Â  Â  Â  }
Â  Â  }
</script>
</body>
</html>

